@model FoodOrderingSystem.Models.ViewModels.DishIngredientsViewModel

@{
    ViewData["Title"] = "Manage Ingredients";
}

<div class="container-fluid">
    <h2>Manage Ingredients for @Model.DishName</h2>
    
    <div class="row">
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header">
                    <h5>Current Ingredients</h5>
                </div>
                <div class="card-body">
                    @if (!Model.CurrentIngredients.Any())
                    {
                        <p class="text-muted">No ingredients added yet.</p>
                    }
                    else
                    {
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Ingredient</th>
                                    <th>Quantity Required</th>
                                    <th>Unit</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var ingredient in Model.CurrentIngredients)
                                {
                                    <tr>
                                        <td>@ingredient.InventoryItem.Name</td>
                                        <td>@ingredient.QuantityRequired</td>
                                        <td>@ingredient.InventoryItem.Unit</td>
                                        <td>
                                            <form asp-action="RemoveIngredient" method="post">
                                                <input type="hidden" name="dishId" value="@Model.DishId" />
                                                <input type="hidden" name="ingredientId" value="@ingredient.InventoryItemId" />
                                                <button type="submit" class="btn btn-sm btn-danger">Remove</button>
                                            </form>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>Add Ingredient</h5>
                </div>
                <div class="card-body">
                    <form asp-action="AddIngredient" method="post">
                        <input type="hidden" name="DishId" value="@Model.DishId" />
                        
                        <div class="form-group mb-3">
                            <label for="InventoryItemId">Ingredient</label>
                            <select name="InventoryItemId" id="InventoryItemId" class="form-select" required>
                                <option value="">-- Select Ingredient --</option>
                                @foreach (var ingredient in Model.AvailableIngredients)
                                {
                                    <option value="@ingredient.Id">@ingredient.Name (@ingredient.Unit)</option>
                                }
                            </select>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="QuantityRequired">Quantity Required</label>
                            <input type="number" name="QuantityRequired" id="QuantityRequired" class="form-control" 
                                   step="0.001" min="0.001" required />
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Add Ingredient</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mt-3">
        <a asp-action="Index" class="btn btn-secondary">Back to Menu</a>
    </div>
</div>